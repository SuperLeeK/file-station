# data 폴더 직접 접근 차단
# site_images 폴더의 이미지 파일만 허용

# Apache 2.4+
<IfModule mod_authz_core.c>
    <FilesMatch "\.(?!jpg|jpeg|png|gif|webp|svg|ico$)">
        Require all denied
    </FilesMatch>
</IfModule>

# Apache 2.2
<IfModule !mod_authz_core.c>
    <FilesMatch "\.(?!jpg|jpeg|png|gif|webp|svg|ico$)">
        Order deny,allow
        Deny from all
    </FilesMatch>
</IfModule>

# site_images 폴더 이미지만 허용, 나머지 모두 차단
<IfModule mod_rewrite.c>
    RewriteEngine On
    # site_images 이미지 허용
    RewriteRule ^site_images/.*\.(jpg|jpeg|png|gif|webp|svg|ico)$ - [L]
    # 그 외 모든 요청 차단
    RewriteRule .* - [F,L]
</IfModule>

# PHP 파일 실행 차단 (보안 강화)
<FilesMatch "\.php$">
    <IfModule mod_authz_core.c>
        Require all denied
    </IfModule>
    <IfModule !mod_authz_core.c>
        Order deny,allow
        Deny from all
    </IfModule>
</FilesMatch>
